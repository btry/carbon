{% block header %}
	<header>
		<h1>GLPI Carbon UI</h1>
	</header>
{% endblock %}

{% block body %}
	<div class="page-body">
		<div class="container-xl">
			<div class="row row-deck row-cards">

				<div class="col-sm-6 col-lg-3">
					<div class="card">
						<div class="card-body">
							<div class="subheader">Total Carbon Emission</div>
							<div class="h1 mb-3" id="carbonEmission"></div>
						</div>
					</div>
				</div>

                <div class="col-sm-6 col-lg-3">
					<div class="card">
						<div class="card-body">
							<div class="subheader">Total Power Consumption</div>
							<div class="h1 mb-3" id="powerConsumption"></div>
						</div>
					</div>
				</div>

                <div class="col-12">
                    <div class="row row-cards">
                        <div class="col-sm-6 col-lg-6">
                            <div class="card">
                                <div class="card-body">
                                    <div class="subheader">Carbon Emission per Type</div>
                                    <div class="h1 mb-3" id="carbonEmissionPerModel"></div>
                                    <div id="carbonEmissionPerModelChart" class="chart-lg"></div>
                                </div>
                            </div>
                        </div>

                        <div class="col-sm-6 col-lg-6">
                            <div class="card">
                                <div class="card-body">
                                    <div class="subheader">Power Consumption per Type</div>
                                    <div class="h1 mb-3" id="powerConsumptionPerModel"></div>
                                    <div id="powerConsumptionPerModelChart" class="chart-lg"></div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

                <div class="col-12">
                    <div class="row row-cards">
                    <div class="col-sm-6 col-lg-6">
                        <div class="card">
                            <div class="card-body">
                                <div class="subheader">Carbon Emission per Month</div>
                                <div class="h1 mb-3" id="carbonEmissionPerMonth"></div>
                                <div id="carbonEmissionPerMonthChart" class="chart-lg"></div>
                            </div>
                        </div>
                    </div>
                </div>

			</div>
		</div>
	</div>
{% endblock %}

{% block footer %}
{% endblock %}

{% block scripts %}
	<script>
	document.addEventListener('DOMContentLoaded', function () {

        var colorPalette = ['#00D8B6','#008FFB',  '#FEB019', '#FF4560', '#775DD0'];

        var donutOptions = {
          series: [44, 55, 41, 17, 15],
          labels: ['Desktops', 'Tablets', 'Mobiles', 'Laptops', 'Others'],
          chart: {
          type: 'donut',
          width: '80%',
        },
        responsive: [{
          breakpoint: 480,
          options: {
            chart: {
              width: 300
            },
            legend: {
              position: 'bottom'
            }
          }
        }]
        };

        var barOptions = {
          series: [{
          data: [400, 540, 1100, 1200, 1380]
        }],
          chart: {
          type: 'bar',
          height: 350
        },
        plotOptions: {
          bar: {
            borderRadius: 4,
            borderRadiusApplication: 'end',
            horizontal: true,
          }
        },
        dataLabels: {
          enabled: false
        },
        xaxis: {
          categories: ['laptop', 'desktop', 'mobile', 'tablet', 'others'],
        }
        };

        var carbonChart = new ApexCharts(document.querySelector("#carbonEmissionPerModelChart"), donutOptions);
        var carbonPerModelChart = new ApexCharts(document.querySelector("#carbonEmissionPerMonthChart"), barOptions);
        carbonChart.render();
        carbonPerModelChart.render();

        fetch(CFG_GLPI['root_doc'] + "/" + GLPI_PLUGINS_PATH.carbon + "/ajax/totalCarbonEmission.php").then(response => {
            console.log(response);
            return response.json();
        }).then(data => {
            let totalCarbonEmission = data;
            document.getElementById('carbonEmission').textContent = totalCarbonEmission;
        });

        fetch(CFG_GLPI['root_doc'] + "/" + GLPI_PLUGINS_PATH.carbon + "/ajax/totalPowerConsumption.php").then(response => {
            console.log(response);
            return response.json();
        }).then(data => {
            let totalPowerConsumption = data;
            document.getElementById('powerConsumption').textContent = totalPowerConsumption;
        });

        fetch(CFG_GLPI['root_doc'] + "/" + GLPI_PLUGINS_PATH.carbon + "/ajax/totalCarbonEmissionPerModel.php").then(response => {
            console.log(response);
            return response.json();
        }).then(data => {
            let carbonEmissionPerModel = data;
            console.log(carbonEmissionPerModel);
        });

        fetch(CFG_GLPI['root_doc'] + "/" + GLPI_PLUGINS_PATH.carbon + "/ajax/carbonEmissionPerMonth").then(response => {
            console.log(response);
            return response.json();
        }).then(data => {
            let carbonEmissionPerMonth = data;
            console.log(carbonEmissionPerMonth);
        });
    });
</script>
{% endblock %}

{% block styles %}
{% endblock %}


